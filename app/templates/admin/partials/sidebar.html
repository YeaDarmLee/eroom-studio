<!-- Sidebar -->

<!-- Mobile Overlay Backdrop -->
<div x-show="sidebarOpen" @click="sidebarOpen = false"
    class="fixed inset-0 z-40 bg-gray-900/50 backdrop-blur-sm lg:hidden"
    x-transition:enter="transition ease-out duration-200" x-transition:enter-start="opacity-0"
    x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-150"
    x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0"></div>

<!-- Mobile Drawer Sidebar -->
<aside
    class="fixed inset-y-0 left-0 z-50 w-64 flex flex-col lg:hidden transform transition-transform duration-300 ease-in-out"
    :class="sidebarOpen ? 'translate-x-0' : '-translate-x-full'">
    <div
        class="flex flex-col w-full h-full bg-gradient-to-b from-white to-gray-50 border-r border-gray-200 shadow-xl overflow-hidden">
        <!-- Logo Section -->
        <div class="flex items-center justify-between h-20 border-b border-gray-200 bg-white px-5 shrink-0">
            <a href="/" class="flex items-center">
                <img src="{{ url_for('static', filename='logo/eroom_studio_x.jpg') }}" alt="Eroom Studio"
                    class="h-12 w-auto">
            </a>
            <button @click="sidebarOpen = false"
                class="p-1.5 rounded-lg text-gray-400 hover:bg-gray-100 hover:text-gray-600 transition-colors">
                <i class="ri-close-line text-xl"></i>
            </button>
        </div>

        <!-- Navigation -->
        <nav class="flex-1 px-3 py-6 space-y-1 overflow-y-auto">
            <template x-for="item in [
                { id: 'dashboard', icon: 'ri-dashboard-line', label: '대시보드' },
                { id: 'users', icon: 'ri-user-settings-line', label: '회원 관리' },
                { id: 'contracts', icon: 'ri-file-list-line', label: '계약 관리' },
                { id: 'coupons', icon: 'ri-coupon-3-line', label: '쿠폰 관리' },
                { id: 'requests', icon: 'ri-tools-line', label: '요청 관리' },
                { id: 'inquiries', icon: 'ri-chat-1-line', label: '문의 관리' },
                { id: 'sms', icon: 'ri-message-3-line', label: '문자메세지' },
                { id: 'branches', icon: 'ri-building-2-line', label: '지점 관리' }
            ]">
                <a href="#" @click.prevent="activeTab = item.id; sidebarOpen = false" :class="{
                        'bg-primary text-white shadow-lg shadow-primary/30': activeTab === item.id,
                        'text-gray-600 hover:bg-white hover:text-gray-900': activeTab !== item.id
                    }" class="flex items-center px-3 py-3 rounded-xl transition-all duration-200">
                    <i :class="item.icon" class="text-xl mr-3"></i>
                    <span class="font-medium" x-text="item.label"></span>
                </a>
            </template>
        </nav>

        <!-- User Section -->
        <div class="p-4 border-t border-gray-200 bg-white">
            <div class="flex items-center space-x-3 px-3 py-2 rounded-xl hover:bg-gray-50 cursor-pointer transition-all duration-200 group"
                @click="logout()">
                <div class="relative flex-shrink-0 w-10 h-10">
                    <div
                        class="w-full h-full bg-gradient-to-tr from-primary to-secondary rounded-full flex items-center justify-center text-white shadow-md ring-2 ring-white">
                        <i class="ri-user-line text-lg"></i>
                    </div>
                    <span
                        class="absolute bottom-0 right-0 w-3 h-3 bg-green-500 border-2 border-white rounded-full"></span>
                </div>
                <div class="flex-1 min-w-0">
                    <p class="text-sm font-semibold text-gray-900 truncate" x-text="user.name"></p>
                    <p class="text-xs text-gray-500 truncate" x-text="user.email"></p>
                </div>
                <i class="ri-logout-box-r-line text-gray-400 group-hover:text-red-500 transition-colors text-base"></i>
            </div>
        </div>
    </div>
</aside>

<!-- Desktop Sidebar -->
<aside class="hidden lg:flex lg:flex-shrink-0 transition-all duration-300 relative"
    :class="sidebarOpen ? 'w-64' : 'w-24'">

    <!-- Sidebar Toggle Button (Floating Pin) -->
    <button @click="sidebarOpen = !sidebarOpen"
        class="absolute -right-3.5 top-1/2 -translate-y-1/2 flex h-7 w-7 items-center justify-center rounded-full bg-white border border-gray-200 shadow-sm hover:shadow-md hover:text-primary transition-all z-50 group">
        <i :class="sidebarOpen ? 'ri-arrow-left-s-line' : 'ri-arrow-right-s-line'"
            class="text-gray-400 group-hover:text-primary transition-colors text-lg"></i>
    </button>

    <div
        class="flex flex-col w-full h-full bg-gradient-to-b from-white to-gray-50 border-r border-gray-200 shadow-lg overflow-hidden">
        <!-- Logo Section -->
        <div
            class="flex items-center justify-center h-24 border-b border-gray-200 bg-white px-4 transition-all duration-300 overflow-hidden shrink-0">
            <a href="/" class="flex items-center justify-center">
                <img :src="sidebarOpen ? '{{ url_for('static', filename='logo/eroom_studio_x.jpg') }}' : '{{ url_for('static', filename='logo/eroom_logo.jpg') }}'"
                    alt="Eroom Studio" class="transition-all duration-300"
                    :class="sidebarOpen ? 'h-16 w-auto' : 'h-12 w-12 object-contain scale-120'">
            </a>
        </div>

        <!-- Navigation -->
        <nav class="flex-1 px-3 py-6 space-y-1 overflow-y-auto">
            <template x-for="item in [
                { id: 'dashboard', icon: 'ri-dashboard-line', label: '대시보드', color: 'blue' },
                { id: 'users', icon: 'ri-user-settings-line', label: '회원 관리', color: 'indigo' },
                { id: 'contracts', icon: 'ri-file-list-line', label: '계약 관리', color: 'green' },
                { id: 'coupons', icon: 'ri-coupon-3-line', label: '쿠폰 관리', color: 'red' },
                { id: 'requests', icon: 'ri-tools-line', label: '요청 관리', color: 'yellow' },
                { id: 'inquiries', icon: 'ri-chat-1-line', label: '문의 관리', color: 'pink' },
                { id: 'sms', icon: 'ri-message-3-line', label: '문자메세지', color: 'orange' },
                { id: 'branches', icon: 'ri-building-2-line', label: '지점 관리', color: 'purple' }
            ]">
                <a href="#" @click.prevent="activeTab = item.id" :class="{
                        'bg-primary text-white shadow-lg shadow-primary/30': activeTab === item.id,
                        'text-gray-600 hover:bg-white hover:text-gray-900': activeTab !== item.id
                    }" :title="!sidebarOpen ? item.label : ''"
                    class="relative flex items-center px-3 py-3 rounded-xl transition-all duration-200 group">
                    <!-- Icon -->
                    <div class="relative flex items-center justify-center w-6">
                        <i :class="item.icon" class="text-xl"></i>
                        <!-- Active Indicator Dot -->
                        <span x-show="activeTab === item.id && !sidebarOpen"
                            class="absolute -top-1 -right-1 w-2 h-2 bg-white rounded-full ring-2 ring-primary"></span>
                    </div>
                    <!-- Label -->
                    <span class="ml-3 font-medium whitespace-nowrap transition-all duration-300" x-show="sidebarOpen"
                        x-transition:enter="transition ease-out duration-200 delay-75"
                        x-transition:enter-start="opacity-0 -translate-x-2"
                        x-transition:enter-end="opacity-100 translate-x-0"
                        x-transition:leave="transition ease-in duration-150" x-transition:leave-start="opacity-100"
                        x-transition:leave-end="opacity-0" x-text="item.label"></span>
                    <!-- Hover Tooltip for Collapsed State -->
                    <div x-show="!sidebarOpen"
                        class="absolute left-full ml-2 px-3 py-1.5 bg-gray-900 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 pointer-events-none transition-opacity duration-200 whitespace-nowrap z-50 shadow-lg"
                        x-text="item.label"></div>
                </a>
            </template>
        </nav>

        <!-- User Section -->
        <div class="p-4 border-t border-gray-200 bg-white">
            <div class="flex items-center rounded-xl hover:bg-gray-50 cursor-pointer transition-all duration-200 group"
                :class="sidebarOpen ? 'space-x-3 px-3 py-2' : 'justify-center p-2'" @click="logout()">
                <!-- Avatar -->
                <div class="relative flex-shrink-0" :class="sidebarOpen ? 'w-10 h-10' : 'w-9 h-9'">
                    <div
                        class="w-full h-full bg-gradient-to-tr from-primary to-secondary rounded-full flex items-center justify-center text-white shadow-md ring-2 ring-white">
                        <i class="ri-user-line" :class="sidebarOpen ? 'text-lg' : 'text-base'"></i>
                    </div>
                    <!-- Online Status Indicator -->
                    <span
                        class="absolute bottom-0 right-0 w-3 h-3 bg-green-500 border-2 border-white rounded-full"></span>
                </div>
                <!-- User Info -->
                <div class="flex-1 min-w-0 transition-all duration-300" x-show="sidebarOpen"
                    x-transition:enter="transition ease-out duration-200 delay-75"
                    x-transition:enter-start="opacity-0 -translate-x-2"
                    x-transition:enter-end="opacity-100 translate-x-0"
                    x-transition:leave="transition ease-in duration-150" x-transition:leave-start="opacity-100"
                    x-transition:leave-end="opacity-0">
                    <p class="text-sm font-semibold text-gray-900 truncate" x-text="user.name"></p>
                    <p class="text-xs text-gray-500 truncate" x-text="user.email"></p>
                </div>
                <!-- Logout Icon -->
                <i class="ri-logout-box-r-line text-gray-400 group-hover:text-red-500 transition-colors"
                    :class="sidebarOpen ? 'text-base' : 'hidden'" x-show="sidebarOpen"></i>
                <!-- Tooltip for collapsed state -->
                <div x-show="!sidebarOpen"
                    class="absolute left-full ml-2 px-3 py-1.5 bg-gray-900 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 pointer-events-none transition-opacity duration-200 whitespace-nowrap z-50 shadow-lg">
                    로그아웃
                </div>
            </div>
        </div>
    </div>
</aside>